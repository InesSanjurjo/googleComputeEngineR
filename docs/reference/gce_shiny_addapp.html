<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Add Shiny app to a Shiny template instance — gce_shiny_addapp • googleComputeEngineR</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">googleComputeEngineR</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/installation-and-authentication.html">Setup</a>
</li>
<li>
  <a href="../articles/creating-vms.html">Creating VMs</a>
</li>
<li>
  <a href="../articles/docker-ssh-futures.html">SSH &amp; Docker</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/example-workflows.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/rstudio-team.html">Custom team RStudio Server</a>
    </li>
    <li>
      <a href="../articles/single-scheduler.html">RStudio Server + scheduler</a>
    </li>
    <li>
      <a href="../articles/shiny-app.html">Shiny App</a>
    </li>
    <li>
      <a href="../articles/opencpu-api-server.html">OpenCPU R API</a>
    </li>
    <li>
      <a href="../articles/scheduled-rscripts.html">Scheduled cron master/slave</a>
    </li>
    <li>
      <a href="../articles/massive-parallel.html">Massive parallel computing</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Help
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../reference/index.html">Reference</a>
    </li>
    <li>
      <a href="../news/index.html">News</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://cloud.google.com/compute/">Google Compute Engine</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Add Shiny app to a Shiny template instance</h1>
    </div>

    
    <p>Add a local shiny app to a running Shiny VM installed via <a href='gce_vm_template.html'>gce_vm_template</a></p>
    

    <pre class="usage"><span class='fu'>gce_shiny_addapp</span>(<span class='no'>instance</span>, <span class='no'>app_image</span>, <span class='kw'>dockerfolder</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>instance</th>
      <td><p>The instance running Shiny</p></td>
    </tr>
    <tr>
      <th>app_image</th>
      <td><p>The name of the Docker image to create or use existing from Google Container Registry. Must be numbers, dashes or lowercase letters only.</p></td>
    </tr>
    <tr>
      <th>dockerfolder</th>
      <td><p>The folder location containing the <code>Dockerfile</code> and app dependencies</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The instance</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>To deploy a Shiny app, you first need to construct a <code>Dockerfile</code> which load the R packages and
  dependencies, as well as copying over the Shiny app in the same folder.</p>
<p>This function will take the Dockerfile, build it into a Docker image and 
  upload it to Google Container Registry for use later.</p>
<p>If already created, then the function will download the <code>app_image</code> from Google Container Registry 
  and start it on the instance provided.</p>
<p>Any existing Shiny Docker containers are stopped and removed, 
  so if you want multiple apps put them in the same <code>Dockerfile</code>.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p>The vignette entry called <code>Shiny App</code> has examples and a walk through.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
An example \code{Dockerfile} is show below.  
This file in the same folder as your shiny app, which consists of a \code{ui.R} and \code{server.R} in a shiny subfolder.  
This is copied into the Dockerfile in the last line.  
Change the name of the subfolder to have that name appear in the final URL of the Shinyapp. 

not_run({
  FROM rocker/shiny
  MAINTAINER Mark Edmondson (r@sunholo.com)
  
  # install R package dependencies
  RUN apt-get update && apt-get install -y \
          libssl-dev \
          ## clean up
          && apt-get clean \ 
          && rm -rf /var/lib/apt/lists/ \ 
          && rm -rf /tmp/downloaded_packages/ /tmp/*.rds
          
  ## Install packages from CRAN
  RUN install2.r --error \ 
       -r 'http://cran.rstudio.com' \
       googleAuthR \
  ## install Github packages
  ## clean up
  && rm -rf /tmp/downloaded_packages/ /tmp/*.rds
  
  ## assume shiny app is in build folder /shiny
  COPY ./shiny/ /srv/shiny-server/shiny/
  
})

This is then run using the R commands below:

not_run({
  
  ## create shiny VM template
  vm <- gce_vm("shiny-test",
               template = "shiny",
               predefined_type = "n1-standard-1")
  
  ## add your SSH keys do docker commands work
  vm <- vm_ssh_setup(vm)
  
  ## a demo Shiny app from googleAuthR
  app_dir <- system.file("dockerfiles","shiny-googleAuthRdemo", package = "googleComputeEngineR")
  
  ## build Dockerfile on VM, and upload created Dockerimage to Container Registry
  gce_shiny_addapp(vm, app_image = "gceshinydemo", dockerfolder = app_dir)
  
  ## if you want to deploy the same Shiny app to a different VM, use the saved Container Registry 
  gce_shiny_addapp(vm2, app_image = "gceshinydemo")
  
})

</div><div class='output co'>#&gt; <span class='error'>Error: &lt;text&gt;:2:4: unexpected symbol</span>
#&gt; <span class='error'>1: </span>
#&gt; <span class='error'>2: An example</span>
#&gt; <span class='error'>      ^</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Mark Edmondson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
