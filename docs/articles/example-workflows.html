<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Example Workflows &bull; googleComputeEngineR</title><!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">googleComputeEngineR</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/installation-and-authentication.html">Setup</a>
</li>
<li>
  <a href="../articles/creating-vms.html">Creating VMs</a>
</li>
<li>
  <a href="../articles/docker-ssh-futures.html">SSH &amp; Docker</a>
</li>
<li>
  <a href="../articles/example-workflows.html">Examples</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Help
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../reference/index.html">Reference</a>
    </li>
    <li>
      <a href="../news/index.html">News</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://cloud.google.com/compute/">Google Compute Engine</a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Example Workflows</h1>
                        <h4 class="author">Mark Edmondson</h4>
            
            <h4 class="date">2016-11-21</h4>
          </div>

    
    
<div class="contents">
<blockquote>
<p>See all documentation on the <a href="https://cloudyr.github.io/googleComputeEngineR/">googleComputeEngineR website</a></p>
</blockquote>
<p>The following are some R scripts for common workflows. They assume you have previously signed up and setup a Google project, authentication and SSH.</p>
<div id="terminology" class="section level1">
<h1 class="hasAnchor"><html><body><a href="#terminology" class="anchor"> </a></body></html>Terminology</h1>
<p>The below refers to these objects:</p>
<ul><li>Instance - Sometimes called Virtual Machine (VM), this is the computer you start in the Google Cloud. It can be configured just like your desktop computer at home. <code>googleComputeEngineR</code> uses instances with the Debain Linux operating system installed. You are charged per minute they are up.</li>
<li>Docker - A program that allows you to run a further type of virtual machine on any computer. The idea is that if any computer installs Docker, they can run the images created.</li>
<li>Docker Image - Templates of the applications you run. Contain all the information and files needed to run it within Docker. They can contain different operating systems to what Docker is installed upon (e.g.&nbsp;you can run a Linux Docker image on OSX)</li>
<li>Docker container - The running process made from a Docker Image when you run them.</li>
</ul><p>Read me about <a href="https://www.docker.com/">Docker here</a>.</p>
<p>An instance/VM can have multiple docker images, which are running multiple docker containers.</p>
</div>
<div id="custom-team-rstudio-server" class="section level1">
<h1 class="hasAnchor"><html><body><a href="#custom-team-rstudio-server" class="anchor"> </a></body></html>Custom Team RStudio Server</h1>
<p>This gives you a private RStudio Server with your custom packages and users.</p>
<p>In summary it:</p>
<ol style="list-style-type: decimal"><li>Launches an RStudio template with Hadley&rsquo;s tidyverse</li>
<li>Lets you add users and passwords</li>
<li>Log into RStudio and install packages as you would in normal RStudio desktop</li>
<li>Once satisfied, save the state of the RStudio into a private Docker repo on Google Container Engine</li>
<li>Lets you start other instances of RStudio server with your custom settings</li>
</ol><div id="launch-the-rstudio-server-template" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#launch-the-rstudio-server-template" class="anchor"> </a></body></html>Launch the RStudio server template</h3>
<p>Here we are setting up a 13GB RAM instance, as found via <code><a href="../reference/gce_list_machinetype.html">gce_list_machinetype()</a></code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(googleComputeEngineR)

## setting up a 13GB RAM instance 
## see gce_list_machinetype() for options of predefined_type
vm &lt;-<span class="st"> </span><span class="kw"><a href="../reference/gce_vm.html">gce_vm</a></span>(<span class="dt">template =</span> <span class="st">"rstudio-hadleyverse"</span>,
             <span class="dt">name =</span> <span class="st">"rstudio-team"</span>,
             <span class="dt">username =</span> <span class="st">"mark"</span>, <span class="dt">password =</span> <span class="st">"mark1234"</span>,
             <span class="dt">predefined_type =</span> <span class="st">"n1-highmem-2"</span>)

## wait a bit, login at the IP it gives you</code></pre></div>
</div>
<div id="add-users-and-setting-up-packages" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#add-users-and-setting-up-packages" class="anchor"> </a></body></html>Add users and setting up packages</h3>
<p>You can add users via:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/gce_rstudio_adduser.html">gce_rstudio_adduser</a></span>(vm, <span class="dt">username =</span> <span class="st">"bill"</span>, <span class="dt">password =</span> <span class="st">"flowerpot"</span>)</code></pre></div>
<p>You can then login at the IP address given via <code>vm</code> or <code><a href="../reference/gce_get_external_ip.html">gce_get_external_ip(vm)</a></code>, and install packages as you would on RStudio Desktop.</p>
</div>
<div id="saving-the-docker-container-to-google-container-registry" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#saving-the-docker-container-to-google-container-registry" class="anchor"> </a></body></html>Saving the Docker container to Google Container REgistry</h3>
<p>Every Google project has its own private Docekr repo called the Container Registry.</p>
<p>This command takes the running container that has your changes and saves it to there.</p>
<p>By default, the RStudio container runs with name &ldquo;rstudio&rdquo; which you can see via <code><a href="../reference/containers.html">containers(vm)</a></code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/gce_push_registry.html">gce_push_registry</a></span>(vm, 
                  <span class="dt">save_name =</span> <span class="st">"my_rstudio"</span>,
                  <span class="dt">container_name =</span> <span class="st">"rstudio"</span>)</code></pre></div>
<p>This can take a while the first time so go make a cup of tea. If successful you should be able to see your container saved at this URL <code>https://console.cloud.google.com/kubernetes/images/list</code></p>
</div>
<div id="start-up-another-vm-your-configuration" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#start-up-another-vm-your-configuration" class="anchor"> </a></body></html>Start up another VM your configuration</h3>
<p>Now say you want a larger more powerful instance, or to launch another with your settings. You can now pull from the Container Registry and start up a VM with your settings enabled.</p>
<p>We use <code>template=rstudio</code> to make sure the right ports and so forth are configured for your Rstudio, and <code>dynamic_image="my_rstudio"</code> to instruct the template to pull from your own image instead of using the default. You need to make sure the dynamic image is based on an RStudio one for this to work correctly.</p>
<p>The function <code>gce_tag_container</code> constructs the name of the custom image on your Container Registry for you.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## construct the correct tag name for your custom image
tag &lt;-<span class="st"> </span><span class="kw"><a href="../reference/gce_tag_container.html">gce_tag_container</a></span>(<span class="st">"my_rstudio"</span>)
<span class="co"># gcr.io/mark-edmondson-gde/my_rstudio</span>

## start a 50GB RAM instance
vm2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/gce_vm.html">gce_vm</a></span>(<span class="dt">name =</span> <span class="st">"rstudio-big"</span>,
              <span class="dt">predefined_type =</span> <span class="st">"n1-highmem-8"</span>,
              <span class="dt">template =</span> <span class="st">"rstudio"</span>,
              <span class="dt">dynamic_image =</span> tag)

## wait for it to launch</code></pre></div>
</div>
<div id="clean-up" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#clean-up" class="anchor"> </a></body></html>Clean up</h3>
<p>You don&rsquo;t get charged for stopped containers, and the next time you start them they will start within 20 seconds.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/gce_vm_stop.html">gce_vm_stop</a></span>(vm2)
<span class="kw"><a href="../reference/gce_vm_stop.html">gce_vm_stop</a></span>(vm)</code></pre></div>
</div>
</div>
<div id="remote-r-cluster" class="section level1">
<h1 class="hasAnchor"><html><body><a href="#remote-r-cluster" class="anchor"> </a></body></html>Remote R cluster</h1>
<p>This workflow takes advatage of the <a href="https://CRAN.R-project.org/package=future"><code>future</code></a> integration to run your local R-functions within a cluster of GCE machines.<br>
You can do this to throw up expensive computations by spinning up a cluster and tearing it down again once you are done.</p>
<p>In summary, this workflow:</p>
<ol style="list-style-type: decimal"><li>Creates a GCE cluster</li>
<li>Lets you perform computations</li>
<li>Stops the VMs</li>
</ol><div id="create-the-cluster" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#create-the-cluster" class="anchor"> </a></body></html>Create the cluster</h3>
<p>The example below uses a default <code>r-base</code> template, but you can use the steps above to create a <code>dynamic_template</code> pulled from the Container Registry if required.</p>
<p>Instead of the more generic <code><a href="../reference/gce_vm.html">gce_vm()</a></code> that is used for more interactive use, we create the instances directly using <code><a href="../reference/gce_vm_container.html">gce_vm_container()</a></code> so it doesn&rsquo;t wait for the job to complete before starting the next (not useful if you have a lot of VMs). You can then use <code><a href="../reference/gce_get_zone_op.html">gce_get_zone_op()</a></code> to get the job status.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(future)
<span class="kw">library</span>(googleComputeEngineR)

## names for your cluster
vm_names &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"vm1"</span>,<span class="st">"vm2"</span>,<span class="st">"vm3"</span>)

## create the cluster using default template for r-base
## creates jobs that are creating VMs in background
jobs &lt;-<span class="st"> </span><span class="kw">lapply</span>(vm_names, function(x) {
    <span class="kw"><a href="../reference/gce_vm_container.html">gce_vm_container</a></span>(<span class="dt">file =</span> <span class="kw"><a href="../reference/get_template_file.html">get_template_file</a></span>(<span class="st">"r-base"</span>),
                     <span class="dt">predefined_type =</span> <span class="st">"n1-highmem-2"</span>,
                     <span class="dt">name =</span> x)
                     })
jobs
<span class="co"># [[1]]</span>
<span class="co"># ==Operation insert :  PENDING</span>
<span class="co"># Started:  2016-11-16 06:52:58</span>
<span class="co"># [[2]]</span>
<span class="co"># ==Operation insert :  PENDING</span>
<span class="co"># Started:  2016-11-16 06:53:04</span>
<span class="co"># [[3]]</span>
<span class="co"># ==Operation insert :  PENDING</span>
<span class="co"># Started:  2016-11-16 06:53:09</span>

## check status of jobs
<span class="kw">lapply</span>(jobs, gce_get_zone_op)
<span class="co"># [[1]]</span>
<span class="co"># ==Operation insert :  DONE</span>
<span class="co"># Started:  2016-11-16 06:52:58</span>
<span class="co"># Ended: 2016-11-16 06:53:14 </span>
<span class="co"># Operation complete in 16 secs </span>

<span class="co"># [[2]]</span>
<span class="co"># ==Operation insert :  DONE</span>
<span class="co"># Started:  2016-11-16 06:53:04</span>
<span class="co"># Ended: 2016-11-16 06:53:20 </span>
<span class="co"># Operation complete in 16 secs </span>

<span class="co"># [[3]]</span>
<span class="co"># ==Operation insert :  DONE</span>
<span class="co"># Started:  2016-11-16 06:53:09</span>
<span class="co"># Ended: 2016-11-16 06:53:30 </span>
<span class="co"># Operation complete in 21 secs</span>

## get the VM objects
vms &lt;-<span class="st"> </span><span class="kw">lapply</span>(vm_names, gce_vm)</code></pre></div>
<p>It is safest to setup the SSH keys seperately for multiple instances, using <code><a href="../reference/gce_ssh_setup.html">gce_ssh_setup()</a></code> - this is normally called for you when you first connect to a VM.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## set up SSH for the VMs
vms &lt;-<span class="st"> </span><span class="kw">lapply</span>(vms, gce_ssh_setup)</code></pre></div>
<p>We now make the VM cluster as per details given in the <a href="https://github.com/HenrikBengtsson/future">future README</a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## make a future cluster
<span class="kw">plan</span>(cluster, <span class="dt">workers =</span> <span class="kw">as.cluster</span>(vms))</code></pre></div>
</div>
<div id="using-the-cluster" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#using-the-cluster" class="anchor"> </a></body></html>Using the cluster</h3>
<p>The cluster is now ready to recieve jobs. You can send them by simply using <code>%&lt;-%</code> instead of <code>&lt;-</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## use %&lt;-% to send functions to work on cluster
## See future README for details: https://github.com/HenrikBengtsson/future
a %&lt;-%<span class="st"> </span><span class="kw">Sys.getpid</span>()

## make a big function to run asynchronously
f &lt;-<span class="st"> </span>function(my_data, args){
   ## ....expensive...computations
   
   result
}

## send to cluster
result %&lt;-%<span class="st"> </span><span class="kw">f</span>(my_data) </code></pre></div>
<p>For long running jobs you can use <code>future::resolved</code> to check on its progress.</p>
<pre><code>## check if resolved
resolved(result)
[1] TRUE</code></pre>
</div>
<div id="cleanup" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#cleanup" class="anchor"> </a></body></html>Cleanup</h3>
<p>Remember to shut down your cluster. You are charged per minute, per instance of uptime.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## shutdown instances when finished
<span class="kw">lapply</span>(vms, gce_vm_stop)</code></pre></div>
</div>
</div>
<div id="rstudio-server-scheduler" class="section level1">
<h1 class="hasAnchor"><html><body><a href="#rstudio-server-scheduler" class="anchor"> </a></body></html>RStudio server + scheduler</h1>
<p>This workflow demonstrates how you can take advatage of <a href="https://docs.docker.com/engine/reference/builder/">Dockerfiles</a> to customise the VM templates.</p>
<p>Using <code>Dockerfiles</code> is recommended if you are making a lot of changes to a template, as its a lot easier to keep track on what is happening.</p>
<p>In summary:</p>
<ol style="list-style-type: decimal"><li>Launch a template VM with the container you want to base yours upon</li>
<li>Construct a <code>Dockerfile</code> in a folder with any other files or dependencies, such as cron</li>
<li>Use <code>docker_build</code> to upload and build your custom Docker image on the VM</li>
<li>Save your custom image to the Container Registry</li>
<li>Launch another VM to run your custom image</li>
<li>Schedule a script to download from Google Analytics, send an email and upload to BigQuery</li>
</ol><div id="launch-a-template-vm" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#launch-a-template-vm" class="anchor"> </a></body></html>Launch a template VM</h3>
<p>Build VMs should be more powerful than the default machine type (<code>f1-micro</code>) else there is a danger of it hanging for big expensive builds.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(googleComputeEngineR)

## installs rocker/hadleyverse docker image
vm &lt;-<span class="st"> </span><span class="kw"><a href="../reference/gce_vm.html">gce_vm</a></span>(<span class="dt">name =</span> <span class="st">"build-schedule-r"</span>, 
             <span class="dt">template =</span> <span class="st">"rstudio-hadleyverse"</span>, 
             <span class="dt">predefined_type =</span> <span class="st">"n1-standard-2"</span>)</code></pre></div>
</div>
<div id="construct-a-dockerfile" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#construct-a-dockerfile" class="anchor"> </a></body></html>Construct a <code>Dockerfile</code></h3>
<p>The <code>Dockerfile</code> here is available via <code>get_dockerfile("hadleyverse-crontab")</code>.</p>
<p>It is shown below, which you could base your own upon. This one installs <code>cron</code> for scheduling, and <code>nano</code> a simple text editor. It then also installs some libraries needed for my scheduled scripts:</p>
<p>From CRAN:</p>
<ul><li><code>googleAuthR</code> - google authentication</li>
<li><code>shinyFiles</code> - for cron jobs</li>
<li><code>googleCloudStorageR</code> - for uploading to Google Cloud Storage</li>
<li><code>bigQueryR</code> - for uploading to BigQuery</li>
<li><code>gmailR</code> - an email R package</li>
<li><code>googleAnalyticsR</code> - for downloading Google Analytics data</li>
</ul><p>From Github</p>
<ul><li><code>bnosac/cronR</code> - to help with creating cron jobs within RStudio.</li>
</ul><div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="kw">FROM</span> rocker/hadleyverse
<span class="kw">MAINTAINER</span> Mark Edmondson (r@sunholo.com)

<span class="co"># install cron and R package dependencies</span>
<span class="kw">RUN</span> apt-get update <span class="kw">&amp;&amp;</span> <span class="kw">apt-get</span> install -y \
    cron \
    nano \
    <span class="co">## clean up</span>
    <span class="kw">&amp;&amp;</span> <span class="kw">apt-get</span> clean <span class="dt">\ </span>
    <span class="kw">&amp;&amp;</span> <span class="kw">rm</span> -rf /var/lib/apt/lists/ <span class="dt">\ </span>
    <span class="kw">&amp;&amp;</span> <span class="kw">rm</span> -rf /tmp/downloaded_packages/ /tmp/*.rds
    
<span class="co">## Install packages from CRAN</span>
<span class="kw">RUN</span> install2.r --error <span class="dt">\ </span>
    <span class="kw">-r</span> <span class="st">'http://cran.rstudio.com'</span> \
    googleAuthR shinyFiles googleCloudStorageR bigQueryR gmailr googleAnalyticsR \
    <span class="co">## install Github packages</span>
    <span class="kw">&amp;&amp;</span> <span class="kw">Rscript</span> -e <span class="st">"devtools::install_github(c('bnosac/cronR'))"</span> \
    <span class="co">## clean up</span>
    <span class="kw">&amp;&amp;</span> <span class="kw">rm</span> -rf /tmp/downloaded_packages/ /tmp/*.rds \</code></pre></div>
</div>
<div id="using-docker_build" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#using-docker_build" class="anchor"> </a></body></html>Using <code>docker_build</code></h3>
<p>We now upload to the instance the Dockerfile, and build a new docker image called <code>my-cron-verse</code>.</p>
<p>This can take some time the first time, so its time for another cup of tea.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## build a new image based on rocker/hadleyverse with this Dockerfile
<span class="kw"><a href="../reference/docker_build.html">docker_build</a></span>(vm, 
             <span class="dt">dockerfile =</span> <span class="kw">get_dockerfile</span>(<span class="st">"hadleyverse-crontab"</span>), 
             <span class="dt">new_image =</span> <span class="st">"my-cron-verse"</span>)

## wait for it to build (5mins +)
<span class="co"># ...</span>
<span class="co"># [0m ---&gt; 059fe3ed926a</span>
<span class="co"># Removing intermediate container 7695f3dc071f</span>
<span class="co"># Successfully built 059fe3ed926a</span>
<span class="co"># Using existing public key in /Users/mark/.ssh/google_compute_engine.pub</span>
<span class="co"># REPOSITORY           TAG                 IMAGE ID            CREATED             SIZE</span>
<span class="co"># my-cron-verse        latest              059fe3ed926a        2 seconds ago       1.933 GB</span>
<span class="co"># rocker/hadleyverse   latest              05e3b636e90b        24 hours ago        1.921 GB</span></code></pre></div>
</div>
<div id="save-your-custom-image-to-the-container-registry" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#save-your-custom-image-to-the-container-registry" class="anchor"> </a></body></html>Save your custom image to the Container Registry</h3>
<p>This image is now saved to the Container Registry</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/gce_push_registry.html">gce_push_registry</a></span>(vm, <span class="st">"my-cron-verse"</span>, <span class="dt">container_name =</span> <span class="st">"myrstudio"</span>)</code></pre></div>
<p>Once that is done, we don&rsquo;t need this instance anymore.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/gce_vm_delete.html">gce_vm_delete</a></span>(vm)</code></pre></div>
</div>
<div id="launch-another-vm-to-run-your-custom-image" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#launch-another-vm-to-run-your-custom-image" class="anchor"> </a></body></html>Launch another VM to run your custom image</h3>
<p>You can now launch instances using your constructed image.</p>
<p>You can also use your custom image to create further <code>Dockerfiles</code> that use it as a dependency, using <code><a href="../reference/gce_tag_container.html">gce_tag_container()</a></code> to get its correct name.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## now start an instance using our rstudio image in cloud-config
## this takes care of rstudio friendly settings, restart behaviour etc.
tag &lt;-<span class="st"> </span><span class="kw"><a href="../reference/gce_tag_container.html">gce_tag_container</a></span>(<span class="st">"my-rstudio"</span>)

## rstudio template, but with your private rstudio build
vm2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/gce_vm.html">gce_vm</a></span>(<span class="dt">name =</span> <span class="st">"myrstudio2"</span>, 
              <span class="dt">template =</span> <span class="st">"rstudio"</span>, 
              <span class="dt">dynamic_image =</span> tag, 
              <span class="dt">username =</span> <span class="st">"mark"</span>, 
              <span class="dt">password =</span> <span class="st">"mark1234"</span>)</code></pre></div>
<p>You can check when the images are downloaded by using <code><a href="../reference/gce_check_container.html">gce_check_container()</a></code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## check on progress on the container pull
<span class="kw"><a href="../reference/gce_check_container.html">gce_check_container</a></span>(vm2, <span class="st">"rstudio"</span>)
<span class="co"># -- Logs begin at Thu 2016-11-17 14:54:38 UTC, end at Thu 2016-11-17 14:57:38 UTC. --</span>
<span class="co"># Nov 17 14:54:43 myrstudio2 docker[1045]: Unable to find image 'gcr.io/mark-edmondson-gde/my-rstudio:latest' locally</span>
<span class="co"># Nov 17 14:54:47 myrstudio2 docker[1045]: latest: Pulling from mark-edmondson-gde/my-rstudio</span>
<span class="co"># Nov 17 14:54:47 myrstudio2 docker[1045]: a84f66826a7f: Pulling fs layer</span>
<span class="co"># ...</span>
<span class="co"># ...</span>
<span class="co"># Nov 17 14:58:36 myrstudio2 docker[1045]: [cont-init.d] conf: exited 0.</span>
<span class="co"># Nov 17 14:58:36 myrstudio2 docker[1045]: [cont-init.d] done.</span>
<span class="co"># Nov 17 14:58:36 myrstudio2 docker[1045]: [services.d] starting services</span>
<span class="co"># Nov 17 14:58:36 myrstudio2 docker[1045]: [services.d] done.</span>

## your custom rstudio instance is now ready
&gt;<span class="st"> </span>vm2
<span class="co"># ==Google Compute Engine Instance==</span>
<span class="co">#</span>
<span class="co"># Name:                myrstudio2</span>
<span class="co"># Created:             2016-11-17 06:54:18</span>
<span class="co"># Machine Type:        f1-micro</span>
<span class="co"># Status:              RUNNING</span>
<span class="co"># Zone:                europe-west1-b</span>
<span class="co"># External IP:         104.199.67.250</span>
<span class="co"># Disks: </span>
<span class="co">#             deviceName       type       mode boot autoDelete</span>
<span class="co"># 1 myrstudio2-boot-disk PERSISTENT READ_WRITE TRUE       TRUE</span></code></pre></div>
<p>You can delete your instances, knowing that the custom image is safe in the Container Registry, or just stop them using <code><a href="../reference/gce_vm_stop.html">gce_vm_stop()</a></code> and start again with <code><a href="../reference/gce_vm_start.html">gce_vm_start()</a></code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## delete the instance (the container is safe)
<span class="kw"><a href="../reference/gce_vm_delete.html">gce_vm_delete</a></span>(vm2)</code></pre></div>
</div>
<div id="a-demo-script" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#a-demo-script" class="anchor"> </a></body></html>A demo script</h3>
<p>A demo script for scheduling is below.</p>
<p>It is not recommended to put critical data within a Docker contianer, as it can be destroyed if the container crashes. Instead, call dedicated data stores such as BigQuery or Cloud Storage, which as you are using Google Compute Engine you already have access to under the same project.</p>
<p>In summary the script below:</p>
<ol style="list-style-type: decimal"><li>Downloads data from Google Analytics</li>
<li>Uploads the data to BigQuery</li>
<li>Uploads the data to Google Cloud Storage</li>
<li>Sends an email giving the daily total</li>
</ol><p>Log into your RStudio Server instance and create the following script:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(googleCloudStorageR)
<span class="kw">library</span>(bigQueryR)
<span class="kw">library</span>(gmailr)
<span class="kw">library</span>(googleAnalyticsR)

## set options for authentication
<span class="kw">options</span>(<span class="dt">googleAuthR.client_id =</span> XXXXX)
<span class="kw">options</span>(<span class="dt">googleAuthR.client_secret =</span> XXXX)
<span class="kw">options</span>(<span class="dt">googleAuthR.scopes.selected =</span> <span class="kw">c</span>(<span class="st">"https://www.googleapis.com/auth/cloud-platform"</span>,
                                        <span class="st">"https://www.googleapis.com/auth/analytics.readonly"</span>))

## authenticate
## using service account, ensure service account email added to GA account, BigQuery user permissions set, etc.
googleAuthR::<span class="kw">gar_auth_service</span>(<span class="st">"auth.json"</span>)

## get Google Analytics data
gadata &lt;-<span class="st"> </span><span class="kw">google_analytics_4</span>(<span class="dv">123456</span>, 
                             <span class="dt">date_range =</span> <span class="kw">c</span>(<span class="kw">Sys.Date</span>() -<span class="st"> </span><span class="dv">2</span>, <span class="kw">Sys.Date</span>() -<span class="st"> </span><span class="dv">1</span>),
                             <span class="dt">metrics =</span> <span class="st">"sessions"</span>,
                             <span class="dt">dimensions =</span> <span class="st">"medium"</span>,
                             <span class="dt">anti_sample =</span> <span class="ot">TRUE</span>)

## upload to Google BigQuery
<span class="kw">bqr_upload_data</span>(<span class="dt">projectId =</span> <span class="st">"myprojectId"</span>, 
                <span class="dt">datasetId =</span> <span class="st">"mydataset"</span>,
                <span class="dt">tableId =</span> <span class="kw">paste0</span>(<span class="st">"gadata_"</span>,<span class="kw">format</span>(<span class="kw">Sys.Date</span>(),<span class="st">"%Y%m%d"</span>)),
                <span class="dt">upload_data =</span> gadata,
                <span class="dt">create =</span> <span class="ot">TRUE</span>)

## upload to Google Cloud Storage
<span class="kw">gcs_upload</span>(gadata, <span class="dt">name =</span> <span class="kw">paste0</span>(<span class="st">"gadata_"</span>,<span class="kw">Sys.Date</span>(),<span class="st">".csv"</span>))


## get top medium referrer
top_ref &lt;-<span class="st"> </span><span class="kw">paste</span>(gadata[<span class="kw">order</span>(gadata$sessions, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>),][<span class="dv">1</span>, ], <span class="dt">collapse =</span> <span class="st">","</span>)
<span class="co"># 3456, organic</span>

## send email with todays figures
daily_email &lt;-<span class="st"> </span><span class="kw">mime</span>(
  <span class="dt">To =</span> <span class="st">"bob@myclient.com"</span>,
  <span class="dt">From =</span> <span class="st">"bill@cool-agency.com"</span>,
  <span class="dt">Subject =</span> <span class="st">"Todays winner is...."</span>,
  <span class="dt">body =</span> <span class="kw">paste0</span>(<span class="st">"Top referrer was: "</span>),top_ref)
<span class="kw">send_message</span>(daily_email)</code></pre></div>
<p>Save the script within RStudio as <code>daily-report.R</code></p>
<p>You can then use <a href="https://github.com/bnosac/cronR"><code>cronR</code></a> to schedule the script for a daily extract.</p>
<p>Use <code>cronR</code>&rsquo;s RStudio addin, or in the console issue:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(cronR)
<span class="kw">cron_add</span>(<span class="kw">paste0</span>(<span class="st">"Rscript "</span>, <span class="kw">normalizePath</span>(<span class="st">"daily-report"</span>)), <span class="dt">frequency =</span> <span class="st">"daily"</span>)
<span class="co"># Adding cronjob:</span>
<span class="co"># ---------------</span>
<span class="co">#</span>
<span class="co"># ## cronR job</span>
<span class="co"># ## id:   fe9168c7543cc83c1c2489de82216c0f</span>
<span class="co"># ## tags: </span>
<span class="co"># ## desc: </span>
<span class="co"># 0 0 * * * Rscript /home/mark/demo-schedule.R</span></code></pre></div>
<p>The script will then run every day.</p>
<p>Test the script locally and with a test schedule before using in production. Once satisfied, you can run locally the <code><a href="../reference/gce_push_registry.html">gce_push_registry()</a></code> again to save the RStudio image with your scehduled script embedded within.</p>
<p>If you want to call the scheduled data from a Shiny app, you can now fetch the data again via <code>bqr_query</code> from <code>bigQueryR</code> or <code>gcs_get_object</code> from <code>googleCloudStorageR</code> within your <code>server.R</code> to pull in the data into your app at runtime.</p>
</div>
</div>
<div id="self-contained-shiny-app" class="section level1">
<h1 class="hasAnchor"><html><body><a href="#self-contained-shiny-app" class="anchor"> </a></body></html>Self-contained Shiny app</h1>
<p>This creates a dedicated Docker container that has all the libraries, files and scripts necessary to run your Shiny app. This example uses a local <code>Dockerfile</code> to install the libraries you need, but in addition also copies your Shiny app scripts so its all self-contained and portable.</p>
<p>The Shiny app can then be deployed on new instances.</p>
<p>In summary:</p>
<ol style="list-style-type: decimal"><li>Create a build VM</li>
<li>Build your custom image with your Shiny app directory included</li>
<li>Push to the Container registry</li>
<li>Deploy to a production VM</li>
</ol><div id="create-a-build-vm" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#create-a-build-vm" class="anchor"> </a></body></html>Create a build VM</h3>
<p>We start with a Shiny template:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(googleComputeEngineR)

## make sure the instance is big enough to install, 
## the default "f1-micro" does not compile packages easily
vm &lt;-<span class="st"> </span><span class="kw"><a href="../reference/gce_vm.html">gce_vm</a></span>(<span class="dt">name =</span> <span class="st">"build-app"</span>, <span class="dt">template =</span> <span class="st">"shiny"</span>, <span class="dt">predefined_type =</span> <span class="st">"n1-standard-2"</span>)</code></pre></div>
</div>
<div id="build-your-custom-image" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#build-your-custom-image" class="anchor"> </a></body></html>Build your custom image</h3>
<p>This is as before, but the <code>Dockerfile</code> also includes a <code>COPY</code> command to copy necessary Shiny <code>ui.R</code> and <code>server.R</code> files into the Docker image.</p>
<p>The Shiny app used is the <a href="https://mark.shinyapps.io/googleAuthRexample/"><code>googleAuthR</code> demo app</a>, and the build directory can be found via: <code><a href="../reference/get_dockerfolder.html">get_dockerfolder("shiny-googleAuthRdemo")</a></code></p>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="kw">FROM</span> rocker/shiny
<span class="kw">MAINTAINER</span> Mark Edmondson (r@sunholo.com)

<span class="co"># install R package dependencies</span>
<span class="kw">RUN</span> apt-get update <span class="kw">&amp;&amp;</span> <span class="kw">apt-get</span> install -y \
    libssl-dev \
    <span class="co">## clean up</span>
    <span class="kw">&amp;&amp;</span> <span class="kw">apt-get</span> clean <span class="dt">\ </span>
    <span class="kw">&amp;&amp;</span> <span class="kw">rm</span> -rf /var/lib/apt/lists/ <span class="dt">\ </span>
    <span class="kw">&amp;&amp;</span> <span class="kw">rm</span> -rf /tmp/downloaded_packages/ /tmp/*.rds
    
<span class="co">## Install packages from CRAN</span>
<span class="kw">RUN</span> install2.r --error <span class="dt">\ </span>
    <span class="kw">-r</span> <span class="st">'http://cran.rstudio.com'</span> \
    googleAuthR \
    <span class="co">## clean up</span>
    <span class="kw">&amp;&amp;</span> <span class="kw">rm</span> -rf /tmp/downloaded_packages/ /tmp/*.rds

<span class="co">## assume shiny app is in build folder /shiny</span>
<span class="kw">COPY</span> ./shiny/ /srv/shiny-server/myapp/</code></pre></div>
<p>Note the <code>COPY</code> command at the end - this copies from a folder in the same location as the <code>Dockerfile</code>. and then places it in the <code>/srv/shiny-server/</code> folder which is the default location for Shiny apps - this location means that the Shiny app will be avialable at <code>your.ip.addr.ess/myapp/</code></p>
<p>We also install <code>googleAuthR</code> from CRAN, and a Debian dependency for <code>googleAuthR</code> that is needed, <code>libssl-dev</code> via <code>apt-get</code>.</p>
<p>The file structure for the build is then:</p>
<pre><code>list.files(get_dockerfolder("shiny-googleAuthRdemo"), recursive = TRUE)
# "Dockerfile"        "shiny/DESCRIPTION" "shiny/readme.md"   "shiny/server.R"    "shiny/ui.R"</code></pre>
<p>We now build the custom image:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/docker_build.html">docker_build</a></span>(vm, 
             <span class="dt">dockerfolder =</span> <span class="kw"><a href="../reference/get_dockerfolder.html">get_dockerfolder</a></span>(<span class="st">"shiny-googleAuthRdemo"</span>),
             <span class="dt">new_image =</span> <span class="st">"shiny_gar"</span>)</code></pre></div>
</div>
<div id="push-to-the-container-registry" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#push-to-the-container-registry" class="anchor"> </a></body></html>Push to the Container registry</h3>
<p>On a successful build, you can now upload to the Container Registry.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## push up to your private Google Container registry
<span class="kw"><a href="../reference/gce_push_registry.html">gce_push_registry</a></span>(vm, 
                  <span class="dt">save_name =</span> <span class="st">"shiny_gar"</span>, 
                  <span class="dt">image_name =</span> <span class="st">"shiny_gar"</span>)
<span class="co"># ...</span>
<span class="co"># ...</span>
<span class="co"># b363013633c9: Pushed</span>
<span class="co"># 4809649dffb9: Pushed</span>
<span class="co"># latest: digest: sha256:cb233f547d84dd94e7616fa7615522e15213d65cc2abb423dd4f3305d19309ce size: 19731</span></code></pre></div>
</div>
<div id="deploy" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#deploy" class="anchor"> </a></body></html>Deploy</h3>
<p>You can now deploy your Shiny app on any instance by calling it from your Container Registry:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## make new Shiny template VM with your self-contained Shiny app
vm2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/gce_vm.html">gce_vm</a></span>(<span class="dt">name =</span> <span class="st">"deployedapp"</span>, 
              <span class="dt">template =</span> <span class="st">"shiny"</span>, 
              <span class="dt">dynamic_image =</span> <span class="kw"><a href="../reference/gce_tag_container.html">gce_tag_container</a></span>(<span class="st">"shiny_gar"</span>),
              <span class="dt">predefined_type =</span> <span class="st">"n1-standard-2"</span>)
              
## check for when image has finished downloading              
<span class="kw"><a href="../reference/gce_check_container.html">gce_check_container</a></span>(vm2, <span class="st">"shinyserver"</span>)
<span class="co"># ...</span>
<span class="co"># ...</span>
<span class="co"># Nov 17 22:11:15 myshinyapp2 docker[1039]: [cont-init.d] done.</span>
<span class="co"># Nov 17 22:11:15 myshinyapp2 docker[1039]: [services.d] starting services</span>
<span class="co"># Nov 17 22:11:15 myshinyapp2 docker[1039]: [services.d] done.</span></code></pre></div>
<p>Your app should now be running on your IP + folder in Dockerfile, such as <code>http://123.456.XXX.XXX/myapp/</code></p>
<p>Clean up the VMs to avoid unnecessary costs:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># delete build VM</span>
<span class="kw"><a href="../reference/gce_vm_delete.html">gce_vm_delete</a></span>(vm)

<span class="co"># stop and start production shiny app as needed</span>
<span class="kw"><a href="../reference/gce_vm_stop.html">gce_vm_stop</a></span>(vm2)</code></pre></div>
</div>
</div>
<div id="setting-up-a-custom-opencpu-server" class="section level1">
<h1 class="hasAnchor"><html><body><a href="#setting-up-a-custom-opencpu-server" class="anchor"> </a></body></html>Setting up a custom OpenCPU server</h1>
<p>The below installs your Github repo into the Docker container using a small <code>Dockerfile</code>.</p>
<p>In summary:</p>
<ol style="list-style-type: decimal"><li>Launch an OpenCPU instance</li>
<li>Build a new OpenCPU image with your Github custom package</li>
<li>Push the image to the Container Registry for safe-keeping</li>
<li>Stop the default OpenCPU docker container and launch your own</li>
</ol><div id="launch-an-opencpu-instance" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#launch-an-opencpu-instance" class="anchor"> </a></body></html>Launch an OpenCPU Instance</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(googleComputeEngineR)

## start an opencpu template
vm &lt;-<span class="st"> </span><span class="kw"><a href="../reference/gce_vm.html">gce_vm</a></span>(<span class="dt">name =</span> <span class="st">"opencpu"</span>, <span class="dt">template =</span> <span class="st">"opencpu"</span>, <span class="dt">predefined_type =</span> <span class="st">"n1-standard-2"</span>)

## wait for opencpu image to load
<span class="kw"><a href="../reference/gce_check_container.html">gce_check_container</a></span>(vm, <span class="st">"opencpu"</span>)</code></pre></div>
</div>
<div id="build-a-new-opencpu-image" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#build-a-new-opencpu-image" class="anchor"> </a></body></html>Build a new OpenCPU image</h3>
<p>This Dockerfile is available via <code><a href="../reference/get_dockerfolder.html">get_dockerfolder("opencpu-installgithub")</a></code> and below. It installs an OpenCPU package from my <a href="code.markedmondson.me/predictClickOpenCPU/supercharge.html#1">prediction of user URLs for prefetching</a> application.</p>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="kw">FROM</span> opencpu/base
<span class="kw">MAINTAINER</span> Mark Edmondson (r@sunholo.com)

<span class="co"># install any package dependencies</span>
<span class="kw">RUN</span> apt-get update <span class="kw">&amp;&amp;</span> <span class="kw">apt-get</span> install -y \
    nano \
    <span class="co">## clean up</span>
    <span class="kw">&amp;&amp;</span> <span class="kw">apt-get</span> clean <span class="dt">\ </span>
    <span class="kw">&amp;&amp;</span> <span class="kw">rm</span> -rf /var/lib/apt/lists/ <span class="dt">\ </span>
    <span class="kw">&amp;&amp;</span> <span class="kw">rm</span> -rf /tmp/downloaded_packages/ /tmp/*.rds
    
<span class="co">## Install your custom package from Github</span>
<span class="kw">RUN</span> Rscript -e <span class="st">"devtools::install_github(c('MarkEdmondson1234/predictClickOpenCPU'))"</span></code></pre></div>
<p>The Dockerfile is used to build the custom image below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## build a docker image with your package installed
<span class="kw"><a href="../reference/docker_build.html">docker_build</a></span>(vm, 
             <span class="dt">dockerfolder =</span> <span class="kw"><a href="../reference/get_dockerfolder.html">get_dockerfolder</a></span>(<span class="st">"opencpu-installgithub"</span>),
             <span class="dt">new_image =</span> <span class="st">"opencpu-predictclick"</span>)</code></pre></div>
</div>
<div id="push-the-image-to-the-container-registry" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#push-the-image-to-the-container-registry" class="anchor"> </a></body></html>Push the image to the Container Registry</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## push up to your private Google Container registry
<span class="kw"><a href="../reference/gce_push_registry.html">gce_push_registry</a></span>(vm, 
                  <span class="dt">save_name =</span> <span class="st">"opencpu-predictclick"</span>, 
                  <span class="dt">image_name =</span> <span class="st">"opencpu-predictclick"</span>)</code></pre></div>
</div>
<div id="deploy-1" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#deploy-1" class="anchor"> </a></body></html>Deploy</h3>
<p>In this case we don&rsquo;t start a new instance, just stop the running OpenCPU container and start our own. We need to stop the default container to free up the ports <code>80</code> and <code>8004</code> that are needed for OpenCPU to work.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## stop default opencpu container
<span class="kw"><a href="../reference/docker_cmd.html">docker_cmd</a></span>(vm, <span class="st">"stop opencpu-server"</span>)

## run custom opencpu server
<span class="kw"><a href="../reference/docker_run.html">docker_run</a></span>(vm, 
           <span class="dt">image =</span> <span class="st">"opencpu-predictclick"</span>, 
           <span class="dt">name =</span> <span class="st">"predictclick"</span>, 
           <span class="dt">detach =</span> <span class="ot">TRUE</span>, 
           <span class="dt">docker_opts =</span> <span class="st">"-p 80:80 -p 8004:8004"</span>)</code></pre></div>
<p>Clean up when you are done to avoid charges.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/gce_vm_stop.html">gce_vm_stop</a></span>(vm)</code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked"><li><a href="#terminology">Terminology</a></li>
      <li><a href="#custom-team-rstudio-server">Custom Team RStudio Server</a></li>
      <li><a href="#remote-r-cluster">Remote R cluster</a></li>
      <li><a href="#rstudio-server-scheduler">RStudio server + scheduler</a></li>
      <li><a href="#self-contained-shiny-app">Self-contained Shiny app</a></li>
      <li><a href="#setting-up-a-custom-opencpu-server">Setting up a custom OpenCPU server</a></li>
      </ul></div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Mark Edmondson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer></div>

  </body></html>
